/* Pactopia360 · Cliente · core-ui.css (v1.9.4) */
/* Main blanco uniforme (tema claro) + tokens de marca + resaltado discreto sin gradientes */

/* ====================== TOKENS ====================== */
:root{
  /* Dark por defecto */
  --bg:#0b111c; --text:#e6e9ef; --muted:#9aa4b2;
  --card:#0f1726; --elev:#121c2e; --border:rgba(255,255,255,.10);
  --ink:#0f172a; --ink-2:#1f2937;

  --brand:#38bdf8; --brand-2:#22c55e; --accent:#10b981;
  --ok:#16a34a; --warn:#f59e0b; --err:#ef4444; --info:#0ea5e9;

  /* Header + logo */
  --header:64px;
  --logo-h:38px;

  --radius:12px; --radius-lg:14px; --radius-sm:10px;
  --shadow:0 10px 28px rgba(0,0,0,.22);
  --chip: color-mix(in oklab, var(--card) 96%, transparent);

  --sidebar-collapsed:72px;
  --sidebar-expanded:248px;
  --container:1180px;

  --fs-11:11px; --fs-12:12px; --fs-13:13px; --fs-14:14px; --fs-16:16px; --fs-20:20px; --fs-24:24px;
  --focus: 0 0 0 2px color-mix(in oklab, var(--brand) 60%, transparent);

  /* Alturas y gaps canónicos */
  --h-xs:30px; --h-sm:36px; --h-md:38px; --h-lg:44px;
  --gap-1:6px; --gap-2:8px; --gap-3:12px; --gap-4:14px; --gap-5:18px;

  /* Realce (fallback al rojo del logo si existe) */
  --hi:#E11D48;
}

/* ====================== TEMA CLARO ====================== */
[data-theme="light"]{
  --bg:#ffffff;    /* fondo general blanco (uniforme con header) */
  --text:#21262c;  --muted:#515a66;

  --card:#ffffff;  --elev:#ffffff;  --border:#e1e4ea;

  --ink:#ffffff; --ink-2:#f8fafc;
  --brand:#22c55e;
  --brand-2:#16a34a;
  --brand-red:#E11D48;     /* rojo del logo para acentos */
  --accent:#0ea5e9;

  --ok:#16a34a; --warn:#f59e0b; --err:#ef4444; --info:#0ea5e9;

  --shadow:0 4px 14px rgba(0,0,0,.06);
  --chip: color-mix(in oklab, var(--card) 98%, transparent);

  /* usa el rojo de marca si está definido */
  --hi: var(--brand-red, #E11D48);
}

/* ====================== RESET ====================== */
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; background:var(--bg); color:var(--text);
  font-family: "Poppins", ui-sans-serif, system-ui, -apple-system, Inter, Segoe UI, Roboto, "Helvetica Neue", Arial;
  font-size: var(--fs-14);
  display:flex; flex-direction:column; min-height:100dvh;
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}
a{ color:inherit; text-decoration:none }
img{ display:block; max-width:100%; height:auto }
button{ font:inherit; color:inherit; border:0; background:none; cursor:pointer }
:focus-visible{ outline:none; box-shadow: var(--focus) }
.visually-hidden{ position:absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0 }

/* ====================== TOPBAR ====================== */
.topbar{
  position:sticky; top:0; z-index:90; height:var(--header);
  display:grid; grid-template-columns: auto 1fr auto; align-items:center; gap:var(--gap-3);
  padding:8px 12px;
  background: color-mix(in oklab, var(--elev) 92%, transparent);
  border-bottom: 1px solid var(--border);
  backdrop-filter: blur(10px) saturate(120%);
  color: var(--text);
}
.brand{ display:flex; align-items:center; gap:10px; min-width:0 }
.brand-logo{ height:var(--logo-h); width:auto; object-fit:contain }

.searchbar{
  display:flex; align-items:center; gap:8px; width:100%; min-width:260px; max-width:860px;
  background:var(--chip); border:1px solid var(--border); border-radius:999px; padding:9px 12px;
}
.searchbar input{ all:unset; width:100%; font-weight:600; letter-spacing:.1px; color:inherit }
.ico{ width:18px; height:18px; opacity:.9 }
.top-actions{ display:flex; align-items:center; gap:var(--gap-2); white-space:nowrap }

/* Etiquetas de cuenta (contraste correcto) */
.topbar .acct-name{ color: var(--text) !important; font-weight:800; }
.topbar .acct-plan{ color: color-mix(in oklab, var(--text) 60%, transparent) !important; font-weight:800; }

/* ====================== BOTONES ====================== */
.btn{
  --btn-h: var(--h-md);
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  height:var(--btn-h); padding:0 12px; border-radius: var(--radius-sm);
  border:1px solid var(--border); background:var(--chip); text-decoration:none; font-weight:800;
}
.btn.icon{ width:38px; height:38px; padding:0; justify-content:center }
.btn.sm{ --btn-h: var(--h-sm); padding:0 10px; font-size: var(--fs-13) }
.btn.lg{ --btn-h: var(--h-lg); padding:0 14px; font-size: var(--fs-16) }
.btn.ghost{ background: transparent }
.btn.primary{ border-color: color-mix(in oklab, var(--brand) 50%, transparent); background: color-mix(in oklab, var(--brand) 16%, transparent) }
.btn.success{ border-color: color-mix(in oklab, var(--brand-2) 50%, transparent); background: color-mix(in oklab, var(--brand-2) 16%, transparent) }
.btn.warn{ border-color: color-mix(in oklab, var(--warn) 40%, transparent); background: color-mix(in oklab, var(--warn) 16%, transparent) }
.btn.outline{ background:transparent; border-color: color-mix(in oklab, var(--text) 24%, transparent) }

.avatar{ --s:32px; display:grid; place-items:center; width:var(--s); height:var(--s); border-radius:999px; background:var(--chip); border:1px solid var(--border); font-weight:900 }
.badge{ display:inline-grid; place-items:center; min-width:16px; height:16px; padding:0 3px; border-radius:999px; background:var(--err); color:#fff; font-size:10px; font-weight:800; transform:translate(8px,-10px) }

/* ====================== BUSCADOR MÓVIL ====================== */
.search-trigger{ display:none }
.search-panel{
  position:fixed; inset:0; z-index:100; display:none;
  background: color-mix(in oklab, var(--ink-2) 60%, rgba(0,0,0,.4));
  backdrop-filter: blur(6px);
}
.search-panel .inner{ max-width:720px; margin:14vh auto 0; padding:12px; }
.search-panel .searchbar{ max-width:none; min-width:unset; padding:12px 14px }
.search-panel .close{
  margin-top:8px; display:inline-flex; align-items:center; gap:8px;
  background:var(--chip); border:1px solid var(--border); border-radius:10px; padding:8px 12px;
}

/* ====================== LAYOUT ====================== */
.shell{ flex:1 1 auto; display:grid; grid-template-columns: var(--sidebar-collapsed) 1fr; min-height:0 }
.sidebar{
  position:sticky; top:var(--header); align-self:start; height:calc(100dvh - var(--header));
  background: color-mix(in oklab, var(--card) 94%, transparent);
  border-right:1px solid var(--border);
  transition: width .18s ease, transform .18s ease; width: var(--sidebar-collapsed);
  overflow:hidden;
}
.sidebar.open{ width: var(--sidebar-expanded) }
.sidebar-scroll{ height:100%; overflow:auto; padding:10px }

.nav-group + .nav-group{ margin-top:10px }
.nav-title{ font-size:var(--fs-11); font-weight:800; color:var(--muted); letter-spacing:.3px; padding:8px 10px }

.nav a{
  position:relative;
  display:grid; grid-template-columns:24px 1fr auto; align-items:center; gap:10px;
  padding:9px 10px; border-radius:10px; border:1px solid transparent;
  color:var(--text); transition: background .12s, border-color .12s;
  white-space:nowrap; min-width:0;
}
.nav a:hover{ background: color-mix(in oklab, var(--text) 6%, transparent); border-color: var(--border) }
.nav a.active{ background: var(--card); border-color: var(--border) }
.nav a.active::before{
  content:''; position:absolute; left:-10px; top:8px; bottom:8px; width:4px; border-radius:4px; background: var(--brand);
}
.kbd{ font-size:10px; color:var(--muted); border:1px solid var(--border); padding:2px 6px; border-radius:8px }

/* Colapsado */
.sidebar:not(.open) .nav-title{ display:none }
.sidebar:not(.open) .nav a span{ display:none }
.sidebar:not(.open) .nav a{ grid-template-columns: 24px; justify-content:center; padding:10px; overflow:visible }
.tip{ position:relative }
.sidebar:not(.open) .tip:hover::after{
  content: attr(data-tip); position:absolute; left: calc(100% + 8px); top:50%; transform:translateY(-50%);
  white-space:nowrap; background:var(--card); border:1px solid var(--border); border-radius:8px;
  padding:6px 8px; font-size:12px; box-shadow:var(--shadow); z-index:50;
}

/* ====================== CONTENT ====================== */
.content{ overflow:auto; padding:14px; min-width:0; }
.container{ width:100%; max-width: var(--container); margin:0 auto }

/* Main blanco uniforme (solo en tema claro) */
html[data-theme="light"] body,
html[data-theme="light"] .content,
html[data-theme="light"] .sidebar{
  background:#fff;
}

/* Tarjetas y elementos comunes */
.card{
  background:var(--card); border:1px solid var(--border);
  border-radius:14px; box-shadow:var(--shadow); padding:14px;
}
.card.headered > .card-head{ display:flex; align-items:center; justify-content:space-between; gap:var(--gap-2); margin-bottom:8px }
.card.headless{ padding-top:12px }
.card .card-title{ font-weight:900; font-size:var(--fs-16) }

.alert{ border-radius:10px; padding:10px 12px; font-weight:700; margin-bottom:12px }
.alert.ok{  background:color-mix(in oklab, var(--ok) 22%, transparent);  border:1px solid color-mix(in oklab, var(--ok) 44%, transparent) }
.alert.err{ background:color-mix(in oklab, var(--err) 18%, transparent); border:1px solid color-mix(in oklab, var(--err) 38%, transparent) }
.alert.info{ background:color-mix(in oklab, var(--info) 18%, transparent); border:1px solid color-mix(in oklab, var(--info) 38%, transparent) }
.alert.warn{ background:color-mix(in oklab, var(--warn) 18%, transparent); border:1px solid color-mix(in oklab, var(--warn) 38%, transparent) }

footer{ border-top:1px solid var(--border); color:var(--muted); padding:12px }

/* ====================== HOME ====================== */
.page-header{ display:flex; align-items:center; justify-content:space-between; gap:var(--gap-3); margin:4px 0 12px; flex-wrap:wrap }
.page-title{ margin:0; font-size:clamp(18px,2.6vw,22px); font-weight:900; color:var(--text) }
.page-sub{ color:var(--muted); font-weight:700 }
.header-actions{ display:flex; align-items:center; gap:var(--gap-2); flex-wrap:wrap }
.select{
  height:var(--h-sm); border-radius:10px; background:var(--chip); border:1px solid var(--border);
  padding:0 8px; color:inherit; font-weight:700;
}

.grid{ display:grid; gap:var(--gap-3) }
.grid-2{ display:grid; gap:var(--gap-3) }
.grid-3{ display:grid; gap:var(--gap-3) }
@media (min-width: 1100px){ .grid-2{ grid-template-columns: 1.2fr .8fr } }
@media (min-width: 1200px){ .grid-3{ grid-template-columns: repeat(3,minmax(0,1fr)) } }

/* KPIs */
.kpis{ display:grid; gap:var(--gap-3); grid-template-columns: 1.2fr .8fr .8fr 1fr }
@media (max-width: 1100px){ .kpis{ grid-template-columns: repeat(2,minmax(0,1fr)) } }
.kpi{
  background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; box-shadow:var(--shadow);
  min-height: 110px; display:grid; align-content:start; gap:8px;
}
.kpi .label{ color:var(--muted); font-size:12px; font-weight:900; letter-spacing:.2px; text-transform:uppercase }
.kpi .value{ font-size:28px; font-weight:900 }
.kpi .hint{ color:var(--muted); font-weight:700 }
.kpi .trend{ font-weight:800 }
.kpi .trend.up{ color: var(--ok) } .kpi .trend.down{ color: var(--err) } .kpi .trend.flat{ color:var(--muted) }
.kpi.primary .value{ font-size:32px }

/* Gráficas */
.chart-card{ background:var(--card); border:1px solid var(--border); border-radius:14px; box-shadow:var(--shadow); padding:12px }
.chart-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px }
.chart-head h3{ margin:0; font-size:14px; font-weight:900 }
.canvas-wrap{ width:100%; height:280px }
.canvas-wrap canvas{ width:100% !important; height:100% !important; display:block }

/* Tablas */
table.list{ width:100%; border-collapse:separate; border-spacing:0 }
table.list th, table.list td{ padding:10px; border-bottom:1px solid var(--border); text-align:left; font-size:14px }
table.list th{ color:var(--muted); font-weight:900 }
.badge.status{ display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); font-weight:800; font-size:12px }
.badge.emitido{ background: color-mix(in oklab, #16a34a 18%, transparent); border-color: color-mix(in oklab, #16a34a 40%, transparent) }
.badge.cancelado{ background: color-mix(in oklab, #ef4444 16%, transparent); border-color: color-mix(in oklab, #ef4444 38%, transparent) }
.badge.borrador{ background: color-mix(in oklab, #0ea5e9 14%, transparent) }
.uuid{ font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px }

/* ====================== RESPONSIVE ====================== */
@media (max-width: 1180px){ .chip{ display:none } }
@media (max-width: 900px){
  .searchbar{ display:none }
  .search-trigger{ display:inline-flex }
}
@media (max-width: 1120px){
  .shell{ grid-template-columns: 0 1fr }
  .sidebar{
    position:fixed; left:8px; right:auto; top: calc(var(--header) + 8px); bottom:8px; height:auto;
    width: var(--sidebar-collapsed); transform: translateX(-115%); border-radius:12px; box-shadow: var(--shadow);
  }
  .sidebar.open{ transform: translateX(0); width: var(--sidebar-expanded) }
}

/* ==== Header · SVG stroke uniforme ==== */
.btn.icon svg{ width:20px; height:20px }
.topbar .ico, .topbar .btn.icon svg, .searchbar .ico{ stroke: currentColor; fill: none; stroke-width: 2; }

/* ===== Facturación (tune UX) ===== */
.tbl tbody tr:nth-child(2n+1) td{ background: color-mix(in oklab, var(--ink-2) 12%, transparent) }
.tbl tbody tr:hover td{ background: color-mix(in oklab, var(--brand) 10%, transparent) }
.fx-chip{ cursor:pointer }
.fx-chip:active{ transform: translateY(1px) }

/* ===================================================================== */
/* === Limpieza de gradientes + resaltado discreto SOLO en lo activo ==== */
/* ===================================================================== */

/* 1) Quitar gradientes globales (fondos planos) */
.topbar,
.searchbar,
.card,
.kpi,
.chart-card,
.alert,
.sidebar,
.content {
  background-image: none !important;
}

/* 2) Sidebar: resaltar SÓLO el módulo activo (contorno rojo suave) */
.sidebar .nav a.active{
  background: var(--card);
  border-color: color-mix(in oklab, var(--hi) 35%, transparent);
  outline: 2px solid color-mix(in oklab, var(--hi) 55%, transparent);
  outline-offset: 2px;
  box-shadow: none;
}
.sidebar .nav a.active::before{
  background: var(--hi); /* barrita izquierda en rojo */
}
.sidebar .nav a:hover{
  outline: 0; /* evita “parpadeo” rojo al hover */
  border-color: var(--border);
}

/* 3) Contenido: usa clase para marcar el panel principal del módulo */
.card.is-current,
.card[data-current="1"],
.module-current,
.mod-current{
  border-color: color-mix(in oklab, var(--hi) 45%, transparent);
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--hi) 25%, transparent);
}

/* 4) Accesibilidad: focus amable en rojo */
.nav a:focus-visible,
.btn:focus-visible,
.select:focus-visible,
input:focus-visible,
textarea:focus-visible {
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--hi) 55%, transparent);
  outline: none;
}

/* 5) Sombra contenida (sin glow) */
.card, .kpi, .chart-card { box-shadow: 0 8px 20px rgba(0,0,0,.06); }

/* (opcional ultra-flat)
.card, .kpi, .chart-card { box-shadow: none; }
*/

/* ======= Layout: contenedor y gutters más amplios ======= */
.content{ padding:24px; }
.container{ max-width: 1240px; }

/* ======= Sidebar: activo tipo “pill” + icono alineado ======= */
.sidebar .nav a{
  grid-template-columns: 20px 1fr auto;
  border-radius: 12px;
}
.sidebar .nav a.active{
  background: color-mix(in oklab, var(--hi) 6%, #fff);
  border-color: color-mix(in oklab, var(--hi) 30%, transparent);
  outline: 0;
  box-shadow: inset 0 0 0 1px color-mix(in oklab, var(--hi) 35%, transparent);
}
.sidebar .nav a.active::before{
  content:''; position:absolute; left:-10px; top:8px; bottom:8px; width:3px; border-radius:3px;
  background: var(--hi);
}

/* ======= Tarjeta base más plana y uniforme ======= */
.card{
  border-radius: 14px;
  border: 1px solid var(--border);
  box-shadow: 0 6px 18px rgba(0,0,0,.05);
  background: var(--card);
}

/* Variantes de tarjeta (usa .card--panel, .card--kpi, .is-current) */
.card--panel{ box-shadow:none; border-color: color-mix(in oklab, var(--text) 8%, transparent); }
.card--kpi{ box-shadow:none; }
.card--kpi .card-head{ margin:-6px -6px 8px; padding:6px; border-bottom:1px dashed color-mix(in oklab, var(--text) 10%, transparent);}
.card--kpi{ border-top:3px solid color-mix(in oklab, var(--hi) 55%, transparent); }

.card.is-current,
.card[data-current="1"]{
  border-color: color-mix(in oklab, var(--hi) 45%, transparent);
  box-shadow: 0 0 0 2px color-mix(in oklab, var(--hi) 18%, transparent);
}

/* ======= KPI: tipografía y jerarquía ======= */
.kpi{ padding:16px; min-height:108px; }
.kpi .label{ font-size:11px; letter-spacing:.3px; text-transform:uppercase; color:var(--muted); }
.kpi .value{ font-size:30px; line-height:1; font-weight:900; }
.kpi .hint{ color:var(--muted); }

/* ======= Tablas: filas “hover” muy sutil ======= */
table.list tr:hover td{
  background: color-mix(in oklab, var(--hi) 6%, transparent);
}

/* ======= Badges de status sin brillo ======= */
.badge.status{
  border:1px solid color-mix(in oklab, var(--text) 14%, transparent);
  background:#fff;
}
.badge.emitido{ border-color: color-mix(in oklab, var(--ok) 40%, transparent); background: color-mix(in oklab, var(--ok) 10%, #fff); }
.badge.cancelado{ border-color: color-mix(in oklab, var(--err) 40%, transparent); background: color-mix(in oklab, var(--err) 8%, #fff); }
.badge.borrador{ border-color: color-mix(in oklab, var(--info) 38%, transparent); background: color-mix(in oklab, var(--info) 8%, #fff); }

/* ======= Chips/acciones rápidas planas ======= */
.fx-chip{ background:#fff; border:1px solid var(--border); border-radius:999px; padding:6px 10px; }
.fx-chip:hover{ background: color-mix(in oklab, var(--hi) 6%, #fff); }

/* ======= Empty states (borde punteado) ======= */
.empty{
  border:2px dashed color-mix(in oklab, var(--text) 16%, transparent);
  border-radius:12px; padding:18px; color:var(--muted);
}
