/* =========================================================
   PACTOPIA360 · DASHBOARD LAYOUT (ACTUALIZADO)
   - Header fijo full-width
   - Sidebar fija bajo header (colapsable, sin logo)
   - Tema claro/oscuro global (toggle desde header)
   - Dropdowns (perfil / notificaciones)
   - Tooltips del sidebar SOLO cuando está colapsado
   ========================================================= */

/* ---- Dimensiones y marca ---- */
:root{
  --header-h: 60px;
  --sidebar-w: 240px;
  --sidebar-w-collapsed: 72px;

  --brand-red:#e31b23;
  --brand-slate:#2d3b4c;
  --brand-charcoal:#131922;

  /* Oscuro (default) */
  --bg: linear-gradient(135deg, #0e141c, #0b1118, #111827);
  --text:#e5e7eb;
  --muted:#9aa3af;

  --header-bg:#0f1620;
  --header-border:rgba(255,255,255,.06);

  --sidebar-bg:#0f1620;
  --sidebar-border:rgba(255,255,255,.06);
  --sidebar-link:#cbd5e1;
  --sidebar-link-active:#fff;
  --sidebar-hover:rgba(255,255,255,.06);
  --sidebar-section:#94a3b8;

  --card-bg:#0f1620;
  --card-border:rgba(255,255,255,.08);

  --btn-bg: linear-gradient(135deg, var(--brand-red), #b7131a);
  --btn-shadow:0 8px 20px rgba(227,27,35,.35);

  --input-bg: var(--card-bg);
  --input-border: var(--header-border);
  --focus-ring: rgba(227,27,35,.18);
  --focus-border: rgba(227,27,35,.80);
}

/* ---- Claro ---- */
body.theme-light{
  --bg: linear-gradient(160deg,#ffffff,#f6f7fb,#f1f5f9);
  --text:#111827;
  --muted:#6b7280;

  --header-bg:#ffffff;
  --header-border:#e5e7eb;

  --sidebar-bg:#ffffff;
  --sidebar-border:#e5e7eb;
  --sidebar-link:#334155;
  --sidebar-link-active:#111827;
  --sidebar-hover:#f3f4f6;
  --sidebar-section:#6b7280;

  --card-bg:#ffffff;
  --card-border:#e5e7eb;

  --btn-bg: linear-gradient(135deg, #ff2a2a, #d0161c);
  --btn-shadow:0 10px 20px rgba(227,27,35,.28);

  --input-bg:#ffffff;
  --input-border:#d1d5db;
}

/* ---- Base ---- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
  color:var(--text);
  background:var(--bg);
  background-size:240% 240%;
  animation: dashBG 24s ease infinite;
}
@keyframes dashBG{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
@media (prefers-reduced-motion: reduce){
  body{animation:none}
}

/* =========================================================
   HEADER FIJO FULL-WIDTH
   ========================================================= */
.header{
  position:fixed; inset:0 0 auto 0; height:var(--header-h);
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:0 14px;
  background:var(--header-bg);
  border-bottom:1px solid var(--header-border);
  z-index:40;
  backdrop-filter:saturate(120%) blur(6px);
}
.header.scrolled{ box-shadow:0 8px 24px rgba(0,0,0,.18) }

.header-left{ display:flex; align-items:center; gap:12px }
.header-right{ display:flex; align-items:center; gap:10px }
.header-usermeta{ display:flex; flex-direction:column; min-width:180px }
.header-usermeta small{ color:var(--muted) }

/* Brand del HEADER (logo solo aquí) */
.brand-link{ display:flex; align-items:center; gap:10px; text-decoration:none; color:inherit }
.brand-name{ font-weight:800; letter-spacing:.02em }
.brand-logo{ height:26px; display:block }
.brand-logo.light { display:none }
body.theme-light .brand-logo.dark { display:none }
body.theme-light .brand-logo.light{ display:inline }

.menu-btn{
  background:transparent;border:1px solid var(--header-border);
  color:var(--text);padding:6px 10px;border-radius:8px;cursor:pointer
}
@media (min-width: 992px){ .menu-btn{ display:none } }

/* Buscador header */
.header-search{ flex:1; max-width:720px }
.search-wrap{ position:relative }
.search-wrap .search-icon{
  position:absolute; left:10px; top:50%; transform:translateY(-50%);
}
.search-wrap input[type="search"]{
  width:100%; padding:10px 12px 10px 34px;
  border-radius:10px; border:1px solid var(--input-border);
  background:var(--input-bg); color:var(--text); outline:none;
  transition: box-shadow .15s ease, border-color .15s ease, background .15s ease;
}
.search-wrap input[type="search"]:focus{
  border-color:var(--focus-border);
  box-shadow:0 0 0 4px var(--focus-ring);
}

/* Tema / Logout / Avatar / Notificaciones */
.theme-btn{
  display:flex;align-items:center;gap:8px;
  padding:6px 10px;border-radius:10px;cursor:pointer;
  border:1px solid var(--header-border);
  background:var(--card-bg);color:var(--text)
}
.logout-btn{
  background:var(--btn-bg);color:#fff;border:0;border-radius:10px;padding:8px 12px;cursor:pointer;
  box-shadow:var(--btn-shadow);font-weight:800
}

/* Dropdowns basados en <details> */
.avatar-menu, .notif-menu{ position:relative }
.avatar-menu > summary::-webkit-details-marker,
.notif-menu  > summary::-webkit-details-marker{ display:none }

.avatar-img{
  height:34px; width:34px; border-radius:50%; border:1px solid var(--header-border); object-fit:cover;
}
.notif-btn{
  list-style:none; display:flex; align-items:center; gap:6px; cursor:pointer;
  background:var(--card-bg); border:1px solid var(--header-border);
  border-radius:10px; padding:6px 10px; position:relative; color:var(--text)
}
.badge{
  position:absolute; top:-6px; right:-6px;
  background:var(--brand-red); color:#fff; border-radius:10px;
  padding:0 6px; font-size:11px; line-height:18px; height:18px;
  display:inline-block; font-weight:700;
}
.dropdown{
  position:absolute; right:0; margin-top:8px;
  background:var(--card-bg); border:1px solid var(--header-border);
  border-radius:12px; min-width:220px; padding:10px; z-index:60; overflow:hidden;
  box-shadow:0 12px 30px rgba(0,0,0,.18);
}
.dropdown .dropdown-header{
  padding:10px 12px; font-weight:800; border-bottom:1px solid var(--header-border)
}
.dropdown .dropdown-body{ max-height:320px; overflow:auto }
.dropdown .dropdown-foot{
  padding:8px 10px; border-top:1px solid var(--header-border);
  display:flex; justify-content:space-between; gap:8px
}
.dropdown a, .dropdown button{
  text-decoration:none; color:var(--text);
  padding:6px 8px; border-radius:8px; border:1px solid var(--header-border);
  background:transparent; cursor:pointer
}

/* Oculta metadatos si no hay espacio */
@media (max-width: 1100px){
  .header-usermeta{ display:none }
}

/* =========================================================
   SIDEBAR FIJA (BAJO EL HEADER) — SIN LOGO
   ========================================================= */
.sidebar{
  position:fixed; top:var(--header-h); left:0; bottom:0;
  width:var(--sidebar-w);
  background:var(--sidebar-bg);
  border-right:1px solid var(--sidebar-border);
  overflow:auto; z-index:50; /* <- fix: sobre el overlay móvil */
  transition: width .15s ease;
}
body.sidebar-collapsed .sidebar{ width:var(--sidebar-w-collapsed); }

/* (Eliminado bloque de brand/logos en sidebar) */

.nav{ padding:10px 8px 60px }
.nav-section{
  padding:12px 10px 6px; font-size:11px; text-transform:uppercase;
  color:var(--sidebar-section); font-weight:700; letter-spacing:.04em
}
.nav-link{
  position:relative;
  display:flex; align-items:center; gap:10px;
  color:var(--sidebar-link); text-decoration:none;
  padding:10px 12px; margin:2px 4px; border-radius:10px;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
  border:1px solid transparent;
}
.nav-link:hover{background:var(--sidebar-hover)}
.nav-link.active{
  background:linear-gradient(135deg, rgba(227,27,35,.15), rgba(227,27,35,.05));
  color:var(--sidebar-link-active); font-weight:700;
  box-shadow:inset 0 0 0 1px rgba(227,27,35,.35)
}
.nav-link .ico{width:20px;text-align:center}

/* Tooltip: por defecto oculto (para evitar duplicados) */
.nav-link .tip{ display:none }

/* Botón colapsar */
.collapse-btn{
  position:sticky; bottom:12px; width:calc(100% - 16px); margin:12px 8px;
  border:1px solid var(--sidebar-border); background:transparent; color:var(--sidebar-section);
  border-radius:10px; padding:8px; cursor:pointer;
}

/* Sidebar colapsada (solo iconos) */
body.sidebar-collapsed .nav-section{ display:none; }
body.sidebar-collapsed .nav-link .txt{ display:none; }
body.sidebar-collapsed .nav-link{ justify-content:center; }

/* Tooltip visible SOLO en colapsado */
body.sidebar-collapsed .nav-link .tip{
  position:absolute; inset:auto auto 50% calc(100% + 8px);
  transform:translateY(50%); white-space:nowrap; display:none;
  background:var(--card-bg); color:var(--text);
  border:1px solid var(--card-border); padding:6px 8px; border-radius:8px;
  box-shadow:0 16px 40px rgba(0,0,0,.18); font-size:12px; pointer-events:none
}
body.sidebar-collapsed .nav-link:hover .tip{ display:block }
body.sidebar-collapsed .nav-link .tip::before{
  content:""; position:absolute; right:100%; top:50%; transform:translateY(-50%);
  border:6px solid transparent; border-right-color:var(--card-bg);
  filter:drop-shadow(-1px 0 0 var(--card-border))
}

/* ---- Móvil: overlay ---- */
@media (max-width: 992px){
  .sidebar{
    transform:translateX(-100%); transition:transform .2s ease;
    width:var(--sidebar-w);
    box-shadow:0 24px 60px rgba(0,0,0,.25);
  }
  body.sidebar-open .sidebar{ transform:translateX(0) }
}

/* =========================================================
   ÁREA PRINCIPAL
   ========================================================= */
.app{ min-height:100% } /* wrapper opcional */

/* Empuje para layouts que usan .main */
.main{
  padding-top: calc(var(--header-h) + 12px);
  margin-left: var(--sidebar-w);
  transition: margin-left .15s ease;
  min-width: 0;
}
body.sidebar-collapsed .main{ margin-left: var(--sidebar-w-collapsed); }
@media (max-width: 992px){
  .main{ margin-left:0 }
}

/* Empuje para tu layout actual que usa .admin-content */
.admin-content{
  margin-left: var(--sidebar-w);
  transition: margin-left .15s ease;
  padding-top: calc(var(--header-h) + 12px);
  min-width:0;
}
body.sidebar-collapsed .admin-content{ margin-left: var(--sidebar-w-collapsed); }
@media (max-width: 992px){
  .admin-content{ margin-left:0 }
}

.content{ padding:16px }

/* =========================================================
   CARDS / KPI / TABLAS
   ========================================================= */
.card{
  background:var(--card-bg); border:1px solid var(--card-border);
  border-radius:14px; padding:14px
}

.cards{ display:grid; gap:12px; grid-template-columns:repeat(12,1fr) }
.card.kpi{ grid-column:span 3 }
@media (max-width:1100px){ .card.kpi{ grid-column:span 6 } }
@media (max-width:640px){  .card.kpi{ grid-column:span 12 } }

.kpi-title{ font-size:12px; color:var(--muted); margin-bottom:6px }
.kpi-value{ font-size:22px; font-weight:800; line-height:1 }
.kpi-delta{ font-size:12px; margin-top:6px }
.kpi-delta.up{ color:#22c55e }
.kpi-delta.down{ color:#ef4444 }

/* Tabla */
.table{ width:100%; border-collapse:collapse }
.table th,.table td{ padding:10px; border-bottom:1px solid var(--card-border); font-size:14px }
.table th{ font-weight:700; color:var(--muted); text-align:left }
.table .empty{ text-align:center; color:var(--muted) }

/* =========================================================
   UTILIDADES
   ========================================================= */
.shadow-sm{ box-shadow:0 6px 16px rgba(0,0,0,.12) }
.shadow-md{ box-shadow:0 12px 30px rgba(0,0,0,.18) }
.rounded-lg{ border-radius:14px }
.hidden{ display:none !important }

/* Scrollbar */
.sidebar::-webkit-scrollbar,
.main  ::-webkit-scrollbar{ width:10px; height:10px }
.sidebar::-webkit-scrollbar-thumb,
.main  ::-webkit-scrollbar-thumb{
  background:rgba(0,0,0,.25); border-radius:10px
}
body.theme-light .sidebar::-webkit-scrollbar-thumb,
body.theme-light .main  ::-webkit-scrollbar-thumb{
  background:rgba(0,0,0,.18)
}

.quick-menu > summary::-webkit-details-marker{display:none}
.kbd{position:absolute;right:8px;top:50%;transform:translateY(-50%);font-size:11px;
     color:var(--muted);border:1px solid var(--header-border);border-radius:6px;padding:2px 6px}


     /* ===== Safety net: asegura que el sidebar quede por encima del overlay y visible en desktop ===== */
.sidebar{ z-index:50; }
@media (min-width: 993px){
  .sidebar{ transform:none !important; } /* nunca fuera de pantalla en desktop */
}
