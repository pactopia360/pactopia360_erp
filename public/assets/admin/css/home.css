/* C:\wamp64\www\pactopia360_erp\public\assets\admin\css\home.css
   ======================================================================
   P360 · Admin Home · v2.0 (SOT)
   OBJETIVO:
   1) Full-bleed real dentro del layout (sin “encajonar”)
   2) Dar estilos completos al Home (toolbar, KPIs, grids, cards, tablas, modal)
   3) Asegurar que Chart.js tenga altura y ocupe el espacio (canvas 100%)
   4) Responsivo: 3/2/1 columnas y spans
   ====================================================================== */

/* ======================================================================
   0) FULL BLEED: anula padding/limitaciones del layout (solo HOME)
   ====================================================================== */
body.p360-admin-home .admin-content .page-container{
  padding:0 !important;
}
body.p360-admin-home .admin-content .page-container > .page-shell{
  max-width:none !important;
  width:100% !important;
  margin:0 !important;
  padding:0 !important;
}
body.p360-admin-home .admin-content .page{
  width:100% !important;
  max-width:none !important;
  margin:0 !important;
}

/* ======================================================================
   1) TOKENS HOME (sin depender de base/ui/app)
   ====================================================================== */
body.p360-admin-home{
  --h-bg: var(--bg, #f6f7f9);
  --h-ink: var(--text, #0f172a);
  --h-mut: var(--muted, #64748b);

  --h-card: var(--card-bg, #ffffff);
  --h-bd: var(--card-border, rgba(0,0,0,.08));
  --h-panel: color-mix(in oklab, var(--h-card) 92%, #0000);

  --h-r: 14px;
  --h-r2: 18px;

  --h-shadow: 0 10px 26px rgba(15,23,42,.08);
  --h-shadow2: 0 18px 44px rgba(15,23,42,.12);

  --h-pad: clamp(12px, 2vw, 18px);
  --h-gap: 14px;
  --h-gap2: 18px;

  --h-btn-bg: color-mix(in oklab, var(--h-card) 92%, #000);
  --h-btn-bd: var(--h-bd);
  --h-btn-ink: var(--h-ink);

  --h-primary: #1f4ddb;
  --h-green: #16a34a;
  --h-red: #ef4444;
  --h-amber: #f59e0b;
  --h-cyan: #06b6d4;
}

/* Dark refinements */
html.theme-dark body.p360-admin-home{
  --h-shadow: 0 12px 30px rgba(0,0,0,.35);
  --h-shadow2: 0 20px 52px rgba(0,0,0,.45);
  --h-btn-bg: color-mix(in oklab, var(--h-card) 86%, #fff0);
}

/* ======================================================================
   2) BASE HOME LAYOUT
   ====================================================================== */
body.p360-admin-home .page{
  padding: var(--h-pad);
  display:flex;
  flex-direction:column;
  gap: var(--h-gap2);
  min-width:0;
}

body.p360-admin-home #alerts{
  width:100%;
  max-width:none;
}

body.p360-admin-home .hidden{ display:none !important; }

/* ======================================================================
   3) OVERLAY LOADING
   ====================================================================== */
body.p360-admin-home #loadingOverlay{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  background: rgba(2,6,23,.28);
  backdrop-filter: blur(2px);
  z-index: 2500;
}
body.p360-admin-home .page[aria-busy="true"] #loadingOverlay{
  display:flex;
}
body.p360-admin-home #loadingOverlay .spinner{
  width:54px;
  height:54px;
  border-radius:999px;
  border:6px solid rgba(255,255,255,.85);
  border-top-color: transparent;
  animation: p360spin 1s linear infinite;
}
@keyframes p360spin{ to{ transform:rotate(360deg) } }

/* ======================================================================
   4) BUTTONS / INPUTS (self-contained)
   ====================================================================== */
body.p360-admin-home .btn{
  appearance:none;
  border:1px solid var(--h-btn-bd);
  background: var(--h-btn-bg);
  color: var(--h-btn-ink);
  border-radius: 10px;
  padding: 7px 10px;
  font: 600 12px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  cursor:pointer;
  transition: transform .06s ease, box-shadow .15s ease, background .15s ease;
  box-shadow: 0 1px 0 rgba(0,0,0,.04);
  white-space:nowrap;
}
body.p360-admin-home .btn:hover{
  box-shadow: 0 10px 20px rgba(15,23,42,.08);
}
body.p360-admin-home .btn:active{
  transform: translateY(1px);
}
body.p360-admin-home .btn:disabled{
  opacity:.55;
  cursor:not-allowed;
}

body.p360-admin-home .btn-primary{
  border-color: color-mix(in oklab, var(--h-primary) 40%, var(--h-bd));
  background: color-mix(in oklab, var(--h-primary) 12%, var(--h-card));
  color: color-mix(in oklab, var(--h-primary) 82%, var(--h-ink));
}

body.p360-admin-home .lbl{
  color: var(--h-mut);
  font: 600 12px/1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  margin-right:6px;
}

body.p360-admin-home .select,
body.p360-admin-home input[type="text"],
body.p360-admin-home input[type="search"]{
  border:1px solid var(--h-bd);
  background: var(--h-card);
  color: var(--h-ink);
  border-radius:10px;
  padding: 7px 10px;
  font: 500 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  outline:none;
}
body.p360-admin-home .select:focus,
body.p360-admin-home input[type="text"]:focus,
body.p360-admin-home input[type="search"]:focus{
  box-shadow: 0 0 0 3px color-mix(in oklab, var(--h-primary) 18%, transparent);
  border-color: color-mix(in oklab, var(--h-primary) 32%, var(--h-bd));
}

/* ======================================================================
   5) PAGE CARD (Filtros + KPIs)
   ====================================================================== */
body.p360-admin-home .page-card{
  width:100%;
  max-width:none;
  background: var(--h-card);
  border:1px solid var(--h-bd);
  border-radius: var(--h-r2);
  box-shadow: var(--h-shadow);
  padding: 14px;
  overflow:hidden;
}

body.p360-admin-home .filters-bar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
  flex-wrap:wrap;
  padding-bottom: 12px;
  margin-bottom: 12px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
}

body.p360-admin-home .filters-left{
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap:wrap;
  min-width:0;
}

body.p360-admin-home .filters-right{
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap:wrap;
}

body.p360-admin-home .btn-group{
  padding: 6px;
  border:1px solid var(--h-bd);
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
  border-radius: 12px;
}

/* KPIs grid */
body.p360-admin-home .kpi-grid{
  display:grid;
  grid-template-columns: repeat(8, minmax(0, 1fr));
  gap: 10px;
}

body.p360-admin-home .kpi-box{
  border:1px solid var(--h-bd);
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
  border-radius: 14px;
  padding: 10px 12px;
  min-height: 66px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  box-shadow: 0 1px 0 rgba(0,0,0,.03);
}
body.p360-admin-home .kpi-label{
  color: var(--h-mut);
  font: 700 11px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  letter-spacing:.2px;
}
body.p360-admin-home .kpi-value{
  color: var(--h-ink);
  font: 800 18px/1.15 system-ui, -apple-system, Segoe UI, Roboto, Arial;
}

/* KPI accents */
body.p360-admin-home .kpi-blue{   border-color: color-mix(in oklab, var(--h-primary) 34%, var(--h-bd)); }
body.p360-admin-home .kpi-green{  border-color: color-mix(in oklab, var(--h-green) 34%, var(--h-bd)); }
body.p360-admin-home .kpi-red{    border-color: color-mix(in oklab, var(--h-red) 34%, var(--h-bd)); }
body.p360-admin-home .kpi-yellow{ border-color: color-mix(in oklab, var(--h-amber) 34%, var(--h-bd)); }

/* KPI responsive */
@media (max-width: 1399.98px){
  body.p360-admin-home .kpi-grid{ grid-template-columns: repeat(4, minmax(0,1fr)); }
}
@media (max-width: 767.98px){
  body.p360-admin-home .kpi-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* ======================================================================
   6) CHARTS GRID
   ====================================================================== */
body.p360-admin-home .charts-grid{
  width:100%;
  max-width:none;
  display:grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: var(--h-gap2);
  align-items:stretch;
}

/* spans por data-span */
body.p360-admin-home .chart-card[data-span="2"]{ grid-column: span 2; }
body.p360-admin-home .chart-card[data-span="3"]{ grid-column: span 3; }

@media (max-width: 1199.98px){
  body.p360-admin-home .charts-grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
  body.p360-admin-home .chart-card[data-span="2"]{ grid-column: span 2; }
}
@media (max-width: 767.98px){
  body.p360-admin-home .charts-grid{ grid-template-columns: 1fr; }
  body.p360-admin-home .chart-card[data-span="2"],
  body.p360-admin-home .chart-card[data-span="3"]{ grid-column: span 1; }
}

/* card */
body.p360-admin-home .chart-card{
  background: var(--h-card);
  border: 1px solid var(--h-bd);
  border-radius: var(--h-r2);
  box-shadow: var(--h-shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  min-width:0;
  min-height: 340px;               /* <- importante: da “cuerpo” */
}

/* head */
body.p360-admin-home .chart-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  padding: 10px 12px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
}
body.p360-admin-home .chart-head.sticky{
  position:sticky;
  top:0;
  z-index: 5;
  backdrop-filter: saturate(140%) blur(10px);
}
body.p360-admin-home .widget-title{
  display:flex;
  align-items:center;
  gap: 8px;
  color: var(--h-ink);
  font: 800 13px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  min-width:0;
}
body.p360-admin-home .widget-title .t{
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}
body.p360-admin-home .chart-tools{
  display:flex;
  align-items:center;
  gap: 8px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

/* chart wrap: altura REAL para canvas */
body.p360-admin-home .chart-wrap{
  position:relative;
  padding: 10px 12px 12px;
  flex:1 1 auto;
  min-height: 240px;
}
body.p360-admin-home .chart-wrap > canvas{
  width:100% !important;
  height:100% !important;
  display:block;
}

/* especiales: cards pequeñas que no deben “inflar” demasiado */
body.p360-admin-home .chart-card[aria-labelledby="chartPlansTitle"]{ min-height: 360px; }
body.p360-admin-home .chart-card[aria-labelledby="chartTopClientsTitle"]{ min-height: 360px; }
body.p360-admin-home .chart-card[aria-labelledby="chartMoMTitle"]{ min-height: 340px; }

/* ======================================================================
   7) TABLE CARD
   ====================================================================== */
body.p360-admin-home .table-card{
  width:100%;
  max-width:none;
  background: var(--h-card);
  border:1px solid var(--h-bd);
  border-radius: var(--h-r2);
  box-shadow: var(--h-shadow);
  overflow:hidden;
}

body.p360-admin-home .table-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 12px;
  flex-wrap:wrap;
  padding: 12px 14px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
}

body.p360-admin-home .table-actions{
  display:flex;
  align-items:center;
  gap: 10px;
  flex-wrap:wrap;
}

body.p360-admin-home .search{
  display:flex;
  align-items:center;
  gap: 8px;
  border:1px solid var(--h-bd);
  border-radius: 12px;
  padding: 6px 10px;
  background: var(--h-card);
}
body.p360-admin-home .search input{
  border:0;
  padding:0;
  background:transparent;
  min-width: 220px;
}
@media (max-width: 767.98px){
  body.p360-admin-home .search input{ min-width: 140px; }
}

body.p360-admin-home .btn-export{
  appearance:none;
  border:1px solid color-mix(in oklab, var(--h-primary) 40%, var(--h-bd));
  background: color-mix(in oklab, var(--h-primary) 10%, var(--h-card));
  color: color-mix(in oklab, var(--h-primary) 82%, var(--h-ink));
  border-radius: 12px;
  padding: 8px 12px;
  font: 800 12px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  cursor:pointer;
}

/* Table */
body.p360-admin-home .table-wrap{
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
body.p360-admin-home table.table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  min-width: 820px;
}
body.p360-admin-home table.table th,
body.p360-admin-home table.table td{
  padding: 10px 12px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
  font: 600 12px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: var(--h-ink);
}
body.p360-admin-home table.table th{
  position:sticky;
  top:0;
  z-index: 2;
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
  backdrop-filter:saturate(140%) blur(10px);
  text-align:left;
  font-weight:800;
}
body.p360-admin-home table.table.striped tbody tr:nth-child(2n){
  background: color-mix(in oklab, var(--h-card) 92%, var(--h-bg));
}
body.p360-admin-home table.table.hover tbody tr:hover{
  background: color-mix(in oklab, var(--h-primary) 6%, var(--h-card));
}
body.p360-admin-home td.empty{
  text-align:center;
  color: var(--h-mut);
  padding: 18px 12px;
}

/* ======================================================================
   8) MODAL (Ingresos por mes)
   ====================================================================== */
body.p360-admin-home .modal{
  position:fixed;
  inset:0;
  display:none;
  z-index: 2600;
}
body.p360-admin-home .modal.open{ display:block; }

body.p360-admin-home .modal-backdrop{
  position:absolute;
  inset:0;
  background: rgba(2,6,23,.45);
  backdrop-filter: blur(2px);
}

body.p360-admin-home .modal-card{
  position:relative;
  width: min(1100px, calc(100vw - 24px));
  margin: 22px auto;
  background: var(--h-card);
  border:1px solid var(--h-bd);
  border-radius: 18px;
  box-shadow: var(--h-shadow2);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  max-height: calc(100vh - 44px);
}

body.p360-admin-home .modal-head{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 12px;
  padding: 14px 16px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
}
body.p360-admin-home .modal-title{
  font: 900 14px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: var(--h-ink);
}
body.p360-admin-home .modal-sub{
  font: 600 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: var(--h-mut);
  margin-top: 2px;
}
body.p360-admin-home .modal-close{
  appearance:none;
  border:1px solid var(--h-bd);
  background: var(--h-btn-bg);
  color: var(--h-ink);
  border-radius: 12px;
  padding: 8px 10px;
  font: 900 12px/1;
  cursor:pointer;
}

body.p360-admin-home .modal-tools{
  display:flex;
  align-items:center;
  gap: 10px;
  padding: 10px 16px;
  border-bottom:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
}
body.p360-admin-home .modal-tools .spacer{ flex:1 1 auto; }

body.p360-admin-home .modal-body{
  padding: 0;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}

/* Tabla modal (densa) */
body.p360-admin-home table.table.dense th,
body.p360-admin-home table.table.dense td{
  padding: 8px 10px;
}
body.p360-admin-home #incomeModalTable tfoot th{
  background: color-mix(in oklab, var(--h-card) 92%, #0000);
  position:sticky;
  bottom:0;
  z-index: 1;
  border-top:1px solid color-mix(in oklab, var(--h-bd) 85%, transparent);
}

/* ======================================================================
   9) ALERTS (si no hay framework)
   ====================================================================== */
body.p360-admin-home .alert{
  border:1px solid var(--h-bd);
  background: var(--h-card);
  border-radius: 14px;
  padding: 10px 12px;
  margin: 0 0 10px 0;
  box-shadow: 0 1px 0 rgba(0,0,0,.03);
  font: 700 12px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
}
body.p360-admin-home .alert-success{
  border-color: color-mix(in oklab, var(--h-green) 40%, var(--h-bd));
  background: color-mix(in oklab, var(--h-green) 10%, var(--h-card));
}
body.p360-admin-home .alert-danger,
body.p360-admin-home .alert-error{
  border-color: color-mix(in oklab, var(--h-red) 40%, var(--h-bd));
  background: color-mix(in oklab, var(--h-red) 10%, var(--h-card));
}
body.p360-admin-home .alert-warning{
  border-color: color-mix(in oklab, var(--h-amber) 40%, var(--h-bd));
  background: color-mix(in oklab, var(--h-amber) 10%, var(--h-card));
}
body.p360-admin-home .alert .alert-close{
  margin-left:10px;
  border:0;
  background:transparent;
  cursor:pointer;
  font-weight:900;
}

/* ======================================================================
   10) PEQUEÑOS FIXES (lo que normalmente rompe el layout)
   ====================================================================== */
body.p360-admin-home .page *{ min-width:0; }

/* si algún global mete “container” a chart-card/table-card */
body.p360-admin-home .page-card,
body.p360-admin-home .table-card,
body.p360-admin-home .charts-grid{
  width:100% !important;
  max-width:none !important;
  margin-left:0 !important;
  margin-right:0 !important;
}

/* Evita que botones se vean “en columna” por estilos globales */
body.p360-admin-home button{ letter-spacing:normal; }

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  body.p360-admin-home *{
    transition:none !important;
    animation:none !important;
    scroll-behavior:auto !important;
  }
}

/* =========================
   P360 HOME · Hotfix moneda
   Quita cualquier sufijo "dólares" puesto por CSS legacy
   ========================= */

.p360-admin-home .kpi-value::after,
.p360-admin-home .kpi-value::before{
  content: none !important;
}

/* Opcional: si había una clase que añade texto */
.p360-admin-home .is-usd::after,
.p360-admin-home .is-usd::before{
  content: none !important;
}
